# PASTA Threat Model Report: {{projectName}}

**Date**: {{generatedDate}} | **Status**: {{riskStatusIcon threatModel.overall_risk_status}} {{threatModel.overall_risk_status}} RISK

---

## Stage 1 & 2: Business Objectives & Technical Scope

*Defining why we care and what we are protecting.*

| Objective | Impact of Breach | Tech Context |
|-----------|-----------------|--------------|
{{#each threatModel.business_objectives}}
| **{{this.objective}}** | {{this.impact_of_breach}} — {{this.description}} | {{this.tech_context}} |
{{/each}}

---

## Stage 3: Application Decomposition (DFD)

*The visual flow of data across trust boundaries.*

```mermaid
graph LR
{{#each dataFlows.flows}}
{{#each this.steps}}
    {{../id}}_{{@index}}["{{this.component}}<br/><i>{{this.type}}</i>"]
{{/each}}
{{#each this.steps}}
{{#unless @last}}
    {{../id}}_{{@index}} -->|"{{#if this.protocol}}{{this.protocol}}{{else}}internal{{/if}}"| {{../id}}_{{add @index 1}}
{{/unless}}
{{/each}}
{{/each}}
{{#each dataFlows.flows}}
{{#each this.trust_boundaries}}
    TB_{{../../id}}_{{@index}}[/"{{this.from}} → {{this.to}}: {{this.control}}"/]
{{/each}}
{{/each}}
```

{{#each dataFlows.flows}}
### {{this.name}}

**Data Classification**: {{this.data_classification}}

| Step | Component | Type | Protocol | Data |
|------|-----------|------|----------|------|
{{#each this.steps}}
| {{add @index 1}} | {{this.component}} | {{this.type}} | {{this.protocol}} | {{#each this.data}}{{this}}{{#unless @last}}, {{/unless}}{{/each}} |
{{/each}}

**Trust Boundaries:**
{{#each this.trust_boundaries}}
- **{{this.from}} → {{this.to}}**: {{this.control}} (Auth: {{this.authentication}})
{{/each}}

{{/each}}

---

## Stage 4 & 5: Threat & Vulnerability Analysis

*Combining external threats with this repo's specific weaknesses.*

{{#each threatModel.attack_surfaces}}
### {{this.name}}

- **Vector**: {{this.vector}}
- **Weakness**: {{this.weakness}}

{{#each this.vulnerabilities}}
| | |
|---|---|
| **Vulnerability** | `[{{this.id}}]` — {{this.title}} |
| **Severity** | {{severityIcon this.severity}} **{{this.severity}}** |
| **Description** | {{this.description}} |

{{/each}}
{{/each}}

---

## Stage 6: Attack Modeling (Simulation)

*How an attacker would realistically exploit these gaps.*

{{#each threatModel.attack_scenarios}}
### Scenario: {{this.name}}

**Objective**: {{this.objective}}

{{#each this.steps}}
{{add @index 1}}. **{{this.phase}}**: {{this.action}}{{#if this.exploits}} *(exploits: {{#each this.exploits}}`{{this}}`{{#unless @last}}, {{/unless}}{{/each}})*{{/if}}
{{/each}}

{{/each}}

---

## Stage 7: Risk & Impact Analysis

*The bottom line for the business.*

{{#each complianceResults}}
{{#if this.risk_analysis.length}}
| Risk ID | PASTA Level | Business Impact | Mitigation Complexity |
|---------|-------------|-----------------|----------------------|
{{#each this.risk_analysis}}
| **{{this.risk_id}}** | {{severityIcon this.pasta_level}} **{{this.pasta_level}}** | {{this.business_impact}} | {{this.mitigation_complexity}} |
{{/each}}
{{/if}}

### {{this.framework}} Compliance ({{this.version}})

**Overall Score: {{this.summary.overall_score}}%** | Compliant: {{this.summary.compliant}} | Partial: {{this.summary.partial}} | Non-Compliant: {{this.summary.non_compliant}}

| Control | Status | Coverage | Evidence |
|---------|--------|----------|----------|
{{#each this.controls}}
| {{this.control_id}} | {{statusIcon this.status}} {{this.status}} | {{this.coverage}}% | {{#each this.evidence}}{{this}}{{#unless @last}}; {{/unless}}{{/each}} |
{{/each}}

{{/each}}

---

## Tactical Recommendations

{{#each complianceResults}}
{{#each this.tactical_recommendations}}
{{add @index 1}}. **{{this.priority}}**: {{this.action}}{{#if this.addresses}} *(addresses: {{#each this.addresses}}`{{this}}`{{#unless @last}}, {{/unless}}{{/each}})*{{/if}}
{{/each}}
{{/each}}

---
*Generated by [thr8](https://github.com/cybrking/thr8) — PASTA Threat Model Generator*
