# Threat Model Report

**Generated**: {{generatedDate}}
**Compliance Frameworks**: {{#each complianceResults}}{{this.framework}}{{#unless @last}}, {{/unless}}{{/each}}

## Executive Summary

| Metric | Value |
|--------|-------|
| Total Threats | {{threatModel.summary.total_threats}} |
| Critical Risk | {{threatModel.summary.by_risk.critical}} |
| High Risk | {{threatModel.summary.by_risk.high}} |
| Medium Risk | {{threatModel.summary.by_risk.medium}} |
| Low Risk | {{threatModel.summary.by_risk.low}} |
| Unmitigated High Risk | {{threatModel.summary.unmitigated_high_risk}} |
{{#each complianceResults}}
| {{this.framework}} Score | {{this.summary.overall_score}}% |
{{/each}}

## System Architecture

```mermaid
graph LR
{{#each dataFlows.flows}}
{{#each this.steps}}
    {{../id}}_{{@index}}["{{this.component}}<br/><i>{{this.type}}</i>"]
{{/each}}
{{#each this.steps}}
{{#unless @last}}
    {{../id}}_{{@index}} -->|"{{#if this.protocol}}{{this.protocol}}{{else}}internal{{/if}}"| {{../id}}_{{add @index 1}}
{{/unless}}
{{/each}}
{{/each}}
{{#each dataFlows.flows}}
{{#each this.trust_boundaries}}
    TB_{{../../id}}_{{@index}}[/"ðŸ”’ {{this.from}} â†’ {{this.to}}<br/>{{this.control}}"/]
{{/each}}
{{/each}}
```

## Data Flows

{{#each dataFlows.flows}}
### {{this.name}}

**Data Classification**: {{this.data_classification}}

| Step | Component | Type | Protocol | Data |
|------|-----------|------|----------|------|
{{#each this.steps}}
| {{add @index 1}} | {{this.component}} | {{this.type}} | {{this.protocol}} | {{#each this.data}}{{this}}{{#unless @last}}, {{/unless}}{{/each}} |
{{/each}}

**Trust Boundaries:**
{{#each this.trust_boundaries}}
- **{{this.from}} â†’ {{this.to}}**: {{this.control}} (Auth: {{this.authentication}})
{{/each}}

{{/each}}

## Threat Analysis

{{#each threatModel.components}}
### {{this.name}} ({{this.type}})

{{#each this.threats}}
#### [{{this.id}}] {{this.title}}

- **Category**: {{this.category}}
- **Risk Score**: {{this.risk_score}}/10
- **Likelihood**: {{this.likelihood}} | **Impact**: {{this.impact}}
- **Residual Risk**: {{this.residual_risk}}

{{this.description}}

**Mitigations:**
{{#each this.mitigations}}
- {{statusIcon this.status}} **{{this.control}}**: {{#if this.evidence}}{{this.evidence}}{{else}}{{this.recommendation}}{{/if}}
{{/each}}

{{/each}}
{{/each}}

## Compliance Assessment

{{#each complianceResults}}
### {{this.framework}} ({{this.version}})

**Overall Score: {{this.summary.overall_score}}%** | Compliant: {{this.summary.compliant}} | Partial: {{this.summary.partial}} | Non-Compliant: {{this.summary.non_compliant}}

| Control | Status | Coverage | Evidence |
|---------|--------|----------|----------|
{{#each this.controls}}
| {{this.control_id}} | {{statusIcon this.status}} {{this.status}} | {{this.coverage}}% | {{#each this.evidence}}{{this}}{{#unless @last}}; {{/unless}}{{/each}} |
{{/each}}

{{#if this.gaps}}
**Gaps:**
{{#each this.controls}}{{#if this.gaps.length}}
{{#each this.gaps}}
- [{{../control_id}}] {{this}}
{{/each}}
{{/if}}{{/each}}
{{/if}}

{{/each}}

## Recommendations

{{#each recommendations}}
### {{this.priority}} Priority

{{#each this.items}}
{{@../index}}.{{@index}}. **{{this.title}}**
   - {{this.description}}
{{/each}}

{{/each}}

---
*Generated by Threat Model Generator Action*
